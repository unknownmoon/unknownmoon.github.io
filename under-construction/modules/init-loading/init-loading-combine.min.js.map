{"version":3,"file":"init-loading-combine.min.js","sources":["init-loading.js","the-base.js"],"names":[],"mappings":"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","sourcesContent":["(function() {\n  function InitLoading(opts) {\n    var self = this;\n    var defaultOpts = {\n      element: document.body,\n      circle: {\n        radius: {\n          min: '10%',\n          step: '5%'\n        },\n        numOfCircle: 6,\n        animationName: 'loadingRot',\n        animationTimingFunction: 'linear',\n        animationDelay: '',\n        animationIterationCount: 'infinite',\n        animationDirection: 'alternate',\n        animationFillMode: '',\n        animationPlayState: 'initial',\n        animationDuration: {\n          min: 1500,\n          step: 500\n        },\n      }\n    };\n\n    function _parseOpts(opts, defaultOpts) {\n      var _opts = {};\n      var tmpOptsArr;\n\n      if (typeof defaultOpts === 'object') {\n        tmpOptsArr = Object.keys(defaultOpts);\n        tmpOptsArr.forEach(function(optName, idx) {\n          if (optName === 'element') {\n            if (opts === undefined || opts[optName] === undefined) {\n              _opts[optName] = defaultOpts[optName];\n            } else {\n              _opts[optName] = opts[optName];\n            }\n            _opts.progressElm = _opts.element.querySelector('.jl-loading-progress');\n            _opts.progressElm.setAttribute('data-progress', '0');\n            _opts.progressElm.innerHTML = '0%';\n            return;\n          }\n\n          // handle object options\n          if (typeof defaultOpts[optName] === 'object') {\n            _opts[optName] = _parseOpts(typeof opts === 'object' ? opts[optName] : undefined, defaultOpts[optName]);\n            // handle primitive options\n          } else {\n            if (opts === undefined || opts[optName] === undefined) {\n              _opts[optName] = defaultOpts[optName];\n            } else {\n              _opts[optName] = opts[optName];\n            }\n          }\n        });\n      }\n      return _opts;\n    }\n\n    function _genValueArr(opts) {\n      var outArr = [];\n      var pattern = /^(\\d+)(.*)$/;\n      var min = opts.min;\n      var step = opts.step;\n      var num = opts.num;\n      var unit = '';\n      var stepUnit = '';\n      var sameUnitFlag = true;\n      var parsedMin = min.match && min.match(pattern);\n      var parsedStep = min.match && step.match(pattern);\n\n      if (!parsedMin || !(parsedMin instanceof Array) || parsedMin[1] === '') {\n        min = typeof min === 'number' ? min : 0;\n      } else {\n        min = parseFloat(parsedMin[1]);\n        unit = parsedMin[2]; // only take the unit of min value\n      }\n\n      if (!parsedStep || !(parsedStep instanceof Array) || parsedStep[1] === '') {\n        step = typeof step === 'number' ? step : 0;\n      } else {\n        step = parseFloat(parsedStep[1]);\n        stepUnit = parsedStep[2]; // used for comparision\n      }\n\n      sameUnitFlag = unit === stepUnit;\n\n      for (var i = 0; i < num; i++) {\n        if (sameUnitFlag) {\n          outArr.push((min + i * step) + unit);\n        } else {\n          if (unit) {\n            outArr.push((min * Math.pow(step, i)) + unit);\n          } else {\n            outArr.push(min + i * step);\n          }\n        }\n      }\n\n      return outArr;\n    }\n\n    function _render(opts) {\n      var svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n      svg.className.baseVal += ' jl-loading';\n      svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n      var circle;\n      var style;\n      var animation;\n\n      for (var i = 0; i < opts.circle.numOfCircle; i++) {\n        animation = opts.circle.animationName + ' ' + opts.genAnimationDuration[opts.circle.numOfCircle - i - 1] + 'ms ' + opts.circle.animationTimingFunction + ' ' + opts.circle.animationDelay + ' ' + opts.circle.animationIterationCount + ' ' + opts.circle.animationDirection + ' ' + opts.circle.animationFillMode;\n\n        // animationPlayState: 'initial',\n\n        style = 'stroke-dasharray:' + opts.genRadius[opts.circle.numOfCircle - i - 1] + ';-webkit-animation:' + animation + ';animation:' + animation + ';';\n\n        circle = document.createElementNS(\"http://www.w3.org/2000/svg\", \"circle\");\n        circle.setAttribute('id', 'c' + (i + 1));\n        circle.setAttribute('cx', '50%');\n        circle.setAttribute('cy', '50%');\n        circle.setAttribute('r', '' + opts.genRadius[opts.circle.numOfCircle - i - 1]);\n        circle.setAttribute('style', style);\n        svg.appendChild(circle);\n      }\n      opts.element.appendChild(svg);\n    }\n\n    function _updateTransformOrigin() {\n      var wrapper = self._opts.element;\n      var circles = wrapper.querySelectorAll('circle');\n      var transformOrigin = {\n        x: wrapper.clientWidth / 2,\n        y: wrapper.clientHeight / 2\n      };\n\n\n      for (var i = 0; i < circles.length; i++) {\n        circles[i].style.transformOrigin = transformOrigin.x + 'px ' + transformOrigin.y + 'px';\n      }\n    }\n\n    function resizeEventHandler(evt) {\n      _updateTransformOrigin();\n    }\n\n    function _destroy() {\n      window.removeEventListener('resize', resizeEventHandler);\n      self._opts.element.style.opacity = 0;\n      setTimeout(function(){\n        self._opts.element.remove();\n      }, 750);\n    }\n\n    function _update(value) {\n      self._opts.progressElm.setAttribute('data-progress', value);\n      self._opts.progressElm.innerHTML = value + '%';\n    }\n\n    function _getProgress() {\n      return self._opts.progressElm.getAttribute('data-progress');\n    }\n\n    self._opts = _parseOpts(opts, defaultOpts);\n    self._opts.genAnimationDuration = _genValueArr({\n      min: self._opts.circle.animationDuration.min,\n      step: self._opts.circle.animationDuration.step,\n      num: self._opts.circle.numOfCircle,\n    });\n    self._opts.genRadius = _genValueArr({\n      min: self._opts.circle.radius.min,\n      step: self._opts.circle.radius.step,\n      num: self._opts.circle.numOfCircle,\n    });\n\n    _render(self._opts);\n    _updateTransformOrigin();\n    window.addEventListener('resize', resizeEventHandler);\n\n    // export\n    return {\n      destroy: _destroy,\n      update: _update,\n      getProgress: _getProgress\n    }\n  }\n\n  // export\n  window.jing = window.jing || {};\n  window.jing.InitLoading = InitLoading;\n}());\n","(function() {\n  var initLoadingElm = document.querySelector('.jl-loading-wrapper');\n  initLoadingElm.classList.remove('invisible');\n  var initLoading = new jing.InitLoading({\n    element: initLoadingElm,\n    circle: {\n      numOfCircle: 4\n    }\n  });\n\n  /*code for development*/\n  (function() {\n    var total = 961607;\n    var loaded = 0;\n    var lastEvtloaded = 0;\n    var isBusy = false;\n    var loadingLinkIdx = 0;\n    var links = [\n      'vendor/angular.js', // 777753\n      'vendor/angular-animate.js', // 77392\n      'vendor/angular-cookies.js', // 5824\n      'vendor/angular-resource.js', // 24314\n      'vendor/angular-route.js', // 33054\n      'vendor/angular-sanitize.js', // 21639\n      'vendor/angular-touch.js' // 21631\n    ];\n\n    function finishLoading() {\n      initLoading.destroy();\n      document.body.classList.add('landing');\n    }\n\n    function progressEventHandler(event) {\n      loaded += event.loaded - lastEvtloaded;\n      lastEvtloaded = event.loaded;\n\n      initLoading.update(Math.min(Math.ceil(loaded / total * 100), 100));\n\n      if (initLoading.getProgress() >= 100) {\n        finishLoading();\n      }\n    }\n\n    function loadFile(link) {\n      var req = new XMLHttpRequest();\n      // report progress events\n      req.addEventListener(\"progress\", progressEventHandler, false);\n\n      // load responseText into a new script element\n      req.addEventListener(\"load\", function(event) {\n        console.log(event);\n        console.log(arguments);\n        var e = event.target;\n        var s = document.createElement(\"script\");\n        s.innerHTML = e.responseText;\n        // or: s[s.innerText!=undefined?\"innerText\":\"textContent\"] = e.responseText\n        document.documentElement.appendChild(s);\n\n        loadingLinkIdx++;\n        if (loadingLinkIdx >= links.length) {\n          finishLoading();\n        } else {\n          lastEvtloaded = 0;\n          loadFile(links[loadingLinkIdx]);\n        }\n\n        s.addEventListener(\"load\", function(evt) {\n          // this runs after the new script has been executed...\n          console.log(evt);\n          console.log(arguments);\n        });\n      }, false);\n\n      req.open(\"GET\", link);\n      req.send();\n    }\n\n    loadFile(links[loadingLinkIdx]);\n\n  }());\n  /*end of code for development*/\n}());\n"],"sourceRoot":"/source/"}